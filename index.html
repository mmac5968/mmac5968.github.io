<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>智能文案提取助手</title>
  <meta name="description" content="抖音/快手/小红书/视频号/B站/微博 全平台一键提取完美文案">
  <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoi5a6J5Y+v6K+l5Y6f6K!95a2X56ymIiwic3RhcnRfdXJsIjoiLi8iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsInRoZW1lX2NvbG9yIjoiIzcyMmVkMSJ9">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>Sparkles</text></svg>">
  <style>
    :root {
      --bg: linear-gradient(135deg, #f5f7ff 0%, #fdfaff 100%);
      --card: rgba(255,255,255,0.96);
      --text: #2d2d2d;
      --text-light: #888;
      --border: rgba(114,46,209,0.16);
      --primary: #722ed1;
      --primary-hover: #5b21b0;
      --success: #13c27f;
      --danger: #ff4d4f;
      --radius: 26px;
      --shadow: 0 20px 50px rgba(114,46,209,0.18);
      --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
      --ease-out-back: cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .dark-mode {
      --bg: linear-gradient(135deg, #0d0a1a 0%, #1a0d2e 100%);
      --card: rgba(30,25,55,0.85);
      --text: #e8e6ff;
      --text-light: #aaa;
      --border: rgba(146,84,222,0.3);
      --shadow: 0 20px 50px rgba(0,0,0,0.6);
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 16px;
      overflow-x: hidden;
      opacity: 0;
      animation: fadeIn 1s var(--ease-out-expo) forwards;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    .top-title {
      font-size: 34px; font-weight: 900; text-align: center;
      background: linear-gradient(90deg, #722ed1, #e13ea5, #ff6b6b);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      margin-bottom: 8px; animation: breathe 5s infinite;
    }
    @keyframes breathe { 0%,100%{opacity:1} 50%{opacity:0.88} }

    .container { max-width: 640px; margin: 0 auto; text-align: center; transform: translateY(20px);
      animation: slideUp 1.2s var(--ease-out-expo) forwards; }
    @keyframes slideUp { to { transform: translateY(0); } }

    h1 { font-size: 28px; font-weight: 900; margin: 12px 0 8px;
      background: linear-gradient(90deg, #722ed1, #e13ea5);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .title-char { display: inline-block; opacity: 0; transform: translateY(30px);
      animation: titlePop 0.8s var(--ease-out-back) forwards; }
    @keyframes titlePop { to { opacity: 1; transform: translateY(0); } }

    .subtitle { color: var(--text-light); font-size: 14px; margin-bottom: 28px;
      opacity: 0; transform: translateY(10px);
      animation: fadeUp 1s var(--ease-out-expo) 0.6s forwards; }
    @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }

    #input {
      width: 100%; min-height: 170px; padding: 22px;
      border: 2px solid var(--border); border-radius: var(--radius);
      font-size: 16.5px; line-height: 1.9; background: var(--card);
      color: var(--text); resize: none; outline: none;
      box-shadow: var(--shadow); transition: all 0.5s var(--ease-out-expo);
      opacity: 0; transform: translateY(30px);
      animation: fadeUp 1s var(--ease-out-expo) 0.4s forwards;
    }
    #input:focus {
      transform: translateY(-2px) scale(1.005);
      border-color: var(--primary);
      box-shadow: 0 0 0 8px rgba(114,46,209,0.22);
    }

    .btn-group { display: flex; gap: 16px; flex-wrap: wrap; justify-content: center; margin: 28px 0; }
    button {
      padding: 15px 28px; border: none; border-radius: 50px;
      font-size: 15.5px; font-weight: 700; cursor: pointer;
      min-height: 56px; box-shadow: var(--shadow);
      position: relative; overflow: hidden;
      transform: translateY(30px); opacity: 0;
    }
    button:nth-child(1) { animation: popIn 0.8s var(--ease-out-back) 0.9s forwards; }
    button:nth-child(2) { animation: popIn 0.8s var(--ease-out-back) 1.0s forwards; }
    button:nth-child(3) { animation: popIn 0.8s var(--ease-out-back) 1.1s forwards; }
    button:nth-child(4) { animation: popIn 0.8s var(--ease-out-back) 1.2s forwards; }
    @keyframes popIn { to { transform: translateY(0); opacity: 1; } }
    .btn-primary { background: var(--primary); color: white; }
    .btn-success { background: var(--success); color: white; }
    .btn-outline { background: transparent; color: var(--text); border: 2.5px solid var(--border); }
    button:active { transform: scale(0.94); }

    #result {
      background: var(--card); padding: 28px; border-radius: var(--radius);
      margin-top: 28px; text-align: left; line-height: 2.3; white-space: pre-wrap;
      font-size: 17.5px; font-weight: 500;
      box-shadow: var(--shadow); border: 1px solid var(--border);
      backdrop-filter: blur(14px);
      transform: translateY(50px); opacity: 0;
      transition: all 0.8s var(--ease-out-expo);
    }
    #result.show { transform: translateY(0); opacity: 1; }
    #result .line { display: block; opacity: 0; transform: translateY(20px);
      animation: lineIn 0.6s var(--ease-out-expo) forwards; }
    @keyframes lineIn { to { opacity: 1; transform: translateY(0); } }

    .result-footer { margin-top: 20px; gap: 16px; opacity: 0; display: none; justify-content: center; }
    .result-footer.show { display: flex; animation: fadeUp 0.8s var(--ease-out-expo) forwards; }

    /* 备忘录卡片样式 */
    .memo-item {
      position: relative;
      background: var(--card); padding: 20px; border-radius: var(--radius);
      margin-bottom: 16px; box-shadow: var(--shadow);
      transform: translateY(30px); opacity: 0;
      transition: all 0.6s var(--ease-out-expo);
    }
    .memo-item.show { transform: translateY(0); opacity: 1; }
    .memo-item:hover { transform: translateY(-10px) scale(1.02); }

    /* 右上角按钮组 */
    .memo-actions {
      position: absolute; top: 12px; right: 12px; display: flex; gap: 8px; opacity: 0;
      transition: opacity 0.3s;
    }
    .memo-item:hover .memo-actions { opacity: 1; }
    .memo-actions button {
      all: unset; width: 36px; height: 36px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 18px; cursor: pointer; transition: all 0.3s;
    }
    .copy-btn { background: var(--success); color: white; }
    .delete-btn { background: var(--danger); color: white; }
    .copy-btn:hover, .delete-btn:hover { transform: scale(1.1); }

    .tip, .footer { opacity: 0; transform: translateY(15px);
      animation: fadeUp 1s var(--ease-out-expo) 1.4s forwards; }

    .toast {
      position: fixed; top: 40px; left: 50%; transform: translateX(-50%) translateY(-120px) scale(0.8);
      background: linear-gradient(135deg, #722ed1, #e13ea5);
      color: white; padding: 16px 36px; border-radius: 50px;
      z-index: 9999; font-weight: 600; font-size: 15px;
      box-shadow: 0 20px 40px rgba(114,46,209,0.4);
      transition: all 0.7s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    }
    .toast.show { transform: translateX(-50%) translateY(0) scale(1); }
  </style>
</head>
<body>
  <div class="top-title">智能文案提取助手</div>
  <div class="container">
    <h1 id="title"></h1>
    <p class="subtitle">抖音 · 快手 · 小红书 · 视频号 · B站 · 微博 全平台一键提取</p>

    <textarea id="input" placeholder="打开即自动读取剪贴板内容，或手动粘贴"></textarea>

    <div class="btn-group">
      <button class="btn-primary" id="btn-clean">一键清理并复制</button>
      <button class="btn-success" onclick="saveToMemo()">保存到备忘录</button>
      <button class="btn-outline" onclick="toggleTheme()">Night Mode 主题</button>
      <button class="btn-outline" onclick="fillExample()">示例文案</button>
    </div>

    <div id="result"></div>
    <div class="result-footer" id="resultFooter">
      <div class="stats">字数：<span id="charCount">0</span></div>
      <button class="btn-outline" onclick="copyAgain()">再次复制</button>
    </div>

    <div id="memoList"></div>

    <p class="tip">
      使用方法：<br>
      1. 在任意 App 长按「复制链接」<br>
      2. 打开本页面 → 自动读取并清理<br>
      3. 长按「一键清理并复制」1.2秒 → 极致纯净模式
    </p>
    <p class="footer">© 2025 纯前端 · 永不失效 · 完全离线可用</p>
  </div>

  <div id="toast" class="toast">已自动读取剪贴板内容</div>

  <script>
    // 标题动画
    "Sparkles 智能文案整理助手".split('').forEach((c,i)=> {
      const s = document.createElement('span');
      s.className='title-char'; s.textContent = c===' '?' ':c;
      s.style.animationDelay = i*0.05+'s';
      document.getElementById('title').appendChild(s);
    });

    let strictMode = false;

    // 主题
    function toggleTheme() {
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('theme', document.body.classList.contains('dark-mode')?'dark':'light');
    }
    if (localStorage.getItem('theme')==='dark' || (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.body.classList.add('dark-mode');
    }

    const textarea = document.getElementById('input');
    textarea.addEventListener('input',()=>{ textarea.style.height='auto'; textarea.style.height=textarea.scrollHeight+'px'; });

    // 终极完美清理函数
    function cleanText(text, forceStrict = false) {
      const isStrict = forceStrict || strictMode;
      return text
        .replace(/复制[本整这]?(条|段|条信息|条消息|信息|消息|笔记|视频|微博|回答).*?[打开用].*?(抖音|快手|小红书|微信|哔哩哔哩|微博|知乎|头条|西瓜视频).*?/gi, '')
        .replace(/复制[本整这]?(条|段|信息|消息).*?(查看|观看|搜索|看|精彩).*?[抖快小红微视]音.*?/gi, '')
        .replace(/https?:\/\/[^\s]+/g, '')
        .replace(/[a-zA-Z0-9]{5,20}:\/\/[^\s]*/g, '')
        .replace(/(douyin|kuaishou|xiaohongshu|b23\.tv|v\.qq\.com|weibo)\.[^\s]*/gi, '')
        .replace(/快手(?:作品|视频)?(?:ID|号)?[\s:：]*[a-zA-Z0-9]{5,20}/gi, '')
        .replace(/小红书号[\s:：]*[A-Z0-9]{5,20}/gi, '')
        .replace(/(av|AV|bv|BV)[0-9a-zA-Z]{6,20}/gi, '')
        .replace(/长按.?复制.?此.*?|立即观看|查看更多|抖音搜索|快手作品ID.?[0-9]+/gi, '')
        .replace(/【[^】]*】|〔[^〕]*〕|「[^」]*」|［[^］]*］/g, '')
        .replace(/^\s*[-—=~•·\*]{2,}\s*$/gm, '')
        .replace(/^\s*[\-|—|•|·]\s*.*/gm, '')
        .replace(/^\s*\d+\.?\s*/gm, '')
        .replace(isStrict ? /#[\u4e00-\u9fa5\w]+/g : /[^a-zA-Z0-9\u4e00-\u9fa5\n]?#[\u4e00-\u9fa5\w]+/g, '')
        .replace(/([。！？\?])\s*/g, '$1\n\n')
        .replace(/([,，])\s*/g, '$1 ')
        .replace(/([…])\s*/g, '$1\n')
        .replace(/\n\s*\n/g, '\n\n')
        .replace(/[ \t]+/g, ' ')
        .replace(/\n[ \t]+/g, '\n')
        .replace(/[ \t]+\n/g, '\n')
        .replace(/\n{3,}/g, '\n\n')
        .trim();
    }

    // 长按极致模式
    let pressTimer;
    const cleanBtn = document.getElementById('btn-clean');
    const startPress = () => {
      pressTimer = setTimeout(() => {
        strictMode = !strictMode;
        showToast(strictMode ? '极致纯净模式已开启' : '已恢复智能模式');
      }, 1200);
    };
    cleanBtn.addEventListener('mousedown', startPress);
    cleanBtn.addEventListener('touchstart', e=>{e.preventDefault();startPress();});
    cleanBtn.addEventListener('mouseup', ()=>clearTimeout(pressTimer));
    cleanBtn.addEventListener('touchend', ()=>clearTimeout(pressTimer));

    // 自动粘贴
    async function autoPaste() {
      try {
        const text = await navigator.clipboard.readText();
        if (text && text.trim() && !textarea.value.trim()) {
          textarea.value = text.trim();
          textarea.dispatchEvent(new Event('input'));
          showToast('已自动读取剪贴板内容');
        }
      } catch(e) {}
    }

    window.cleanAndCopy = async function () {
      let raw = textarea.value.trim();
      if (!raw) return;
      const cleaned = cleanText(raw);
      if (!cleaned) { alert('清理后为空'); return; }

      const result = document.getElementById('result');
      result.innerHTML = cleaned.split('\n\n').map((l,i)=>`<span class="line" style="animation-delay:${i*0.15}s">${l||' '}</span>`).join('');
      result.style.display = 'block';
      result.classList.remove('show');
      setTimeout(()=>result.classList.add('show'),50);

      document.getElementById('resultFooter').classList.add('show');
      document.getElementById('charCount').textContent = cleaned.replace(/\s/g,'').length;

      await navigator.clipboard.writeText(cleaned);
      showToast(strictMode?'已复制极致纯净文案！':'已复制完美文案！');
      showMemos();
    };

    window.copyAgain = () => { navigator.clipboard.writeText(document.getElementById('result').textContent); showToast('再次复制成功'); };

    // 新增：复制备忘录文案
    async function copyMemo(content) {
      await navigator.clipboard.writeText(content);
      showToast('已复制备忘录文案');
    }

    function saveToMemo() {
      const c = document.getElementById('result').textContent || cleanText(textarea.value);
      if (!c.trim()) return;
      const m = JSON.parse(localStorage.getItem('memos')||'[]');
      m.unshift({content:c,time:Date.now()});
      localStorage.setItem('memos',JSON.stringify(m));
      showToast('已保存到备忘录'); showMemos();
    }

    function deleteMemo(i) {
      let m = JSON.parse(localStorage.getItem('memos')||'[]');
      m.splice(i,1); localStorage.setItem('memos',JSON.stringify(m));
      showMemos();
    }

    function showMemos() {
      const m = JSON.parse(localStorage.getItem('memos')||'[]');
      const list = document.getElementById('memoList');
      if (!m.length) { list.innerHTML=''; return; }
      list.innerHTML = `<h3 style="margin:28px 0 18px;color:var(--primary);font-size:20px;opacity:0;animation:fadeUp 1s forwards;">我的备忘录 (${m.length})</h3>` +
        m.map((item,i)=>{
          const prev = item.content.length>100 ? item.content.slice(0,100)+'...' : item.content;
          const t = new Date(item.time).toLocaleString('zh-CN',{month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'});
          return `<div class="memo-item" style="animation-delay:${i*0.08}s">
            <small style="color:var(--text-light);display:block;margin-bottom:8px;">${t}</small>
            <div style="white-space:pre-wrap;font-size:15.5px;">${prev}</div>
            <div class="memo-actions">
              <button class="copy-btn" onclick="event.stopPropagation();copyMemo('${item.content.replace(/'/g, "\\'")}')">Copy</button>
              <button class="delete-btn" onclick="event.stopPropagation();deleteMemo(${i})">×</button>
            </div>
          </div>`;
        }).join('');
      setTimeout(()=>document.querySelectorAll('.memo-item').forEach(el=>el.classList.add('show')),100);
    }

    function fillExample() {
      textarea.value = `我们终其一生向往的远方，原来是家门口的风景
这里的一草一木，是刻在骨子里的乡愁，也是别人的诗和远方…

#生活碎片 #治愈系 #日常碎片 #情绪治愈`;
      textarea.dispatchEvent(new Event('input'));
    }

    function showToast(msg) {
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.classList.remove('show');
      setTimeout(() => t.classList.add('show'), 10);
      setTimeout(() => t.classList.remove('show'), 2600);
    }

    // 初始化
    textarea.dispatchEvent(new Event('input'));
    showMemos();
    setTimeout(autoPaste, 600);
  </script>
</body>
</html>